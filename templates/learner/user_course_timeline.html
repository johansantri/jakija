{% extends 'home/tes.html' %}
{% load static %}

{% block content %}
<section class="bg-white border border-gray-200 p-6 rounded-lg shadow-sm hover:shadow-md transition">

    <h2 class="text-2xl font-bold mb-6"> <a href="{% url 'authentication:mycourse' %}"> <i class="fas fa-backward"></i> My Activity - {{ course.course_name }}</a></h2>
    <p>Total active days in the course: <strong>{{ total_days }}</strong></p>
    <br>
    {% if timeline %}
    <div class="relative">
        <!-- Vertical line -->
        <div class="absolute left-5 top-0 h-full w-1 bg-gray-200"></div>

        <ul class="space-y-8 ml-10">
            {% for activity in timeline %}
            <li class="relative flex items-start space-x-4">

                <!-- Timeline dot -->
                <div class="absolute -left-1.5 top-2 w-3 h-3 rounded-full 
                    {% if activity.activity_type == 'enrolled' %}bg-blue-500
                    {% elif activity.activity_type == 'material_read' %}bg-green-500
                    {% elif activity.activity_type == 'assessment_completed' %}bg-yellow-500
                    {% elif activity.activity_type == 'certificate_issued' %}bg-purple-500
                    {% elif activity.activity_type == 'course_review' %}bg-orange-500
                    {% else %}bg-gray-400{% endif %}">
                </div>

                <!-- Icon -->
                <div class="flex-shrink-0">
                    {% if activity.activity_type == 'enrolled' %}
                        <span class="text-blue-500 text-xl">üì•</span>
                    {% elif activity.activity_type == 'material_read' %}
                        <span class="text-green-500 text-xl">üìñ</span>
                    {% elif activity.activity_type == 'assessment_completed' %}
                        <span class="text-yellow-500 text-xl">üìù</span>
                    {% elif activity.activity_type == 'certificate_issued' %}
                        <span class="text-purple-500 text-xl">üéì</span>
                    {% elif activity.activity_type == 'course_review' %}
                        <span class="text-orange-500 text-xl">‚≠ê</span>
                    {% else %}
                        <span class="text-gray-500 text-xl">üîπ</span>
                    {% endif %}
                </div>

                <!-- Activity Card -->
                <div class="bg-gray-50 p-4 rounded-lg shadow-sm flex-1 hover:shadow-md transition">
                    <p class="text-gray-800 font-semibold">
                        {% if activity.activity_type == 'enrolled' %}
                            Enrolled in Course: {{ activity.description }}
                        {% elif activity.activity_type == 'material_read' %}
                            Read Material: {{ activity.description }}
                        {% elif activity.activity_type == 'assessment_completed' %}
                            Completed Assessment: {{ activity.description }}
                        {% elif activity.activity_type == 'certificate_issued' %}
                            Certificate Issued: {{ activity.description }}
                        {% elif activity.activity_type == 'course_review' %}
                            Course Review:
                            <span class="text-orange-500">
                                {% for i in "12345"|slice:":activity.description.rating"|make_list %}
                                    ‚≠ê
                                {% endfor %}
                            </span>
                        {% endif %}
                    </p>

                    {% if activity.activity_type == 'course_review' and activity.comment %}
                        <p class="text-gray-600 mt-1 italic">"{{ activity.comment }}"</p>
                    {% endif %}

                    <p class="text-gray-500 text-sm mt-1">
                        {{ activity.timestamp|date:"M d, Y H:i" }}
                    </p>
                </div>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% else %}
        <p class="text-gray-500">No activity found for this course yet.</p>
    {% endif %}

</section>
{% endblock %}
