{% extends 'home/set.html' %}
{% load static %}

{% block title %}
  <a href="{% url 'authentication:dashbord' %}">
    {{ course_name|default:"Kursus" }}
  </a>
{% endblock %}

{% block content %}
<div id="content-area">
  {% include 'learner/partials/content.html' %}
</div>
{% endblock %}

{% block extra_scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Timer untuk quiz (jika ada elemen #timer)
    const timerElement = document.getElementById('timer');
    if (timerElement && !timerElement.dataset.initialized) {
      timerElement.dataset.initialized = 'true';
      let timeLeft = parseInt(timerElement.textContent);
      const interval = setInterval(() => {
        timeLeft--;
        timerElement.textContent = timeLeft;
        if (timeLeft <= 0) {
          clearInterval(interval);
          timerElement.closest('div')?.insertAdjacentHTML('afterend',
            '<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">Waktu habis!</div>');
        }
      }, 1000);
    }

    // Log error HTMX
    document.body.addEventListener('htmx:afterRequest', function(evt) {
      if (evt.detail.xhr.status >= 400) {
        console.error('HTMX request failed:', evt.detail.xhr.status, evt.detail.xhr.responseText);
      }
    });

    htmx.process(document.body);
    document.body.dispatchEvent(new Event('contentLoaded'));
  });
</script>
{% endblock %}