{% extends 'home/tes.html' %}
{% load static %}

{% block content %}

<h1 class="text-2xl font-bold text-gray-800 mb-6">List of Captured Micro-Credentials</h1>

<!-- Search Form -->
<form method="get" action="{% url 'authentication:microcredential' %}" class="mb-6">
    <div class="flex max-w-md">
        <input type="text" name="search" value="{{ search_query }}" placeholder="Search for microcredentials"
               class="flex-1 border border-gray-300 rounded-l-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" />
        <button type="submit" 
                class="bg-blue-600 text-white px-4 py-2 rounded-r-md hover:bg-blue-700">Search</button>
    </div>
</form>

{% if page_obj %}
<!-- Table for Microcredentials -->
<div class="overflow-x-auto bg-white shadow rounded-lg">
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-100">
            <tr>
                <th class="px-6 py-3 text-left text-sm font-medium text-gray-700">Micro-Credential Title</th>
                <th class="px-6 py-3 text-left text-sm font-medium text-gray-700">Enrollment Date</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
            {% for enrollment in page_obj %}
            <tr class="hover:bg-gray-50">
                <td class="px-6 py-4">
                    <a href="{% url 'courses:microcredential_detail' enrollment.microcredential.slug %}" 
                       class="text-blue-600 hover:underline font-medium">
                        {{ enrollment.microcredential.title }}
                    </a>
                </td>
                <td class="px-6 py-4">{{ enrollment.enrolled_at|date:"d M Y" }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Pagination Controls -->
<div class="mt-4 flex justify-center space-x-2 text-sm">
    {% if page_obj.has_previous %}
        <a href="?page=1&search={{ search_query }}" class="px-3 py-1 border rounded text-gray-700 bg-white hover:bg-gray-100">First</a>
        <a href="?page={{ page_obj.previous_page_number }}&search={{ search_query }}" class="px-3 py-1 border rounded text-gray-700 bg-white hover:bg-gray-100">Previous</a>
    {% else %}
        <span class="px-3 py-1 border rounded text-gray-400 bg-gray-100 cursor-not-allowed">First</span>
        <span class="px-3 py-1 border rounded text-gray-400 bg-gray-100 cursor-not-allowed">Previous</span>
    {% endif %}

    <span class="px-3 py-1 border rounded bg-white text-gray-700">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>

    {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}&search={{ search_query }}" class="px-3 py-1 border rounded text-gray-700 bg-white hover:bg-gray-100">Next</a>
        <a href="?page={{ page_obj.paginator.num_pages }}&search={{ search_query }}" class="px-3 py-1 border rounded text-gray-700 bg-white hover:bg-gray-100">Last</a>
    {% else %}
        <span class="px-3 py-1 border rounded text-gray-400 bg-gray-100 cursor-not-allowed">Next</span>
        <span class="px-3 py-1 border rounded text-gray-400 bg-gray-100 cursor-not-allowed">Last</span>
    {% endif %}
</div>

{% else %}
<p class="text-gray-500">You haven't enrolled in any microcredentials yet.</p>
{% endif %}

{% endblock %}
