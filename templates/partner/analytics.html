{% extends 'home/tes.html' %}
{% load static custom_filters %}{% block content %}<div class="w-full lg:w-10/12 mx-auto">
  <h2 class="text-center mb-4 text-blue-600 font-bold text-2xl">
    <i class="bi bi-bar-chart-line mr-2"></i>Partner Analytics
  </h2>
  <p class="text-center text-gray-500 mb-5 text-lg leading-relaxed">
    Gain insights into course views and engagement metrics
  </p>

  <!-- Tombol Navigasi -->
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3 mb-5">
    <div class="w-full">
      <a href="{% url 'partner:heatmap' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'heatmap' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-grid-3x3 mr-2 inline"></i>User Activity Heatmap
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:login_trends' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'login_trends' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-graph-up-arrow mr-2 inline"></i>Login Trends
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:learning_duration' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'learning_duration' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-clock-history mr-2 inline"></i>Learning Duration Analytics
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:participant_geography' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'participant_geography' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-geo-alt mr-2 inline"></i>Geographic Analytics
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:device_usage' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'device_usage' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-pc-display mr-2 inline"></i>Device Usage Analytics
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:popular_courses' %}" class="block w-full px-4 py-2 text-sm font-medium border border-green-500 text-green-700 bg-white rounded-md hover:bg-green-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'popular_courses' %}bg-green-500 text-white{% endif %} text-center">
        <i class="bi bi-star mr-2 inline"></i>Popular Courses
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:user_growth' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'user_growth' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-person-plus mr-2 inline"></i>New User Growth
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:course_completion_rate' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'course_completion_rate' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-check2-circle mr-2 inline"></i>Course Completion Rate
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:retention_rate' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'retention_rate' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-people mr-2 inline"></i>Retention Rate
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:top_courses_by_rating' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'top_courses_by_rating' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-star-fill mr-2 inline"></i>Top Courses by Rating
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:course_enrollment_growth' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'course_enrollment_growth' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-graph-up-arrow mr-2 inline"></i>Course Enrollment Growth
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:course_dropoff_rate' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'course_dropoff_rate' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-person-dash-fill mr-2 inline"></i>Course Drop-off Rate
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:certificate_analytics' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'certificate_analytics' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-patch-check mr-2 inline"></i>Certificate Analytics
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:active_partners' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'active_partners' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-building mr-2 inline"></i>Most Active Partners
      </a>
    </div>
    <div class="w-full">
      <a href="{% url 'partner:transaction_trends' %}" 
         class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'transaction_trends' %}bg-blue-500 text-white{% endif %} text-center">
        <i class="bi bi-cash-stack mr-2 inline"></i>Transaction Trends
      </a>
    </div>

<div class="w-full">
  <a href="{% url 'partner:top_transaction_partners' %}" 
     class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'top_transaction_partners' %}bg-blue-500 text-white{% endif %} text-center">
    <i class="bi bi-currency-exchange mr-2 inline"></i>Top Transaction Partners
  </a>
</div>

<div class="w-full">
  <a href="{% url 'partner:top_courses_revenue' %}" class="block w-full px-4 py-2 text-sm font-medium border border-blue-500 text-blue-700 bg-white rounded-md hover:bg-blue-50 transition-all duration-300 hover:-translate-y-0.5 {% if request.resolver_match.url_name == 'top_courses_revenue' %}bg-blue-500 text-white{% endif %} text-center">
    <i class="bi bi-currency-dollar mr-2 inline"></i>Top Courses Revenue
  </a>
</div>  </div>

  <!-- Stat Boxes -->
  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-5">
    <div class="bg-white border-0 shadow-lg rounded-xl h-full text-center">
      <div class="p-4">
        <h6 class="text-gray-500 mb-2"><i class="bi bi-eye me-1 inline"></i>Weekly Views</h6>
        <h3 class="font-bold text-blue-600 mb-0 text-xl">{{ weekly_views }}</h3>
      </div>
    </div>
    <div class="bg-white border-0 shadow-lg rounded-xl h-full text-center">
      <div class="p-4">
        <h6 class="text-gray-500 mb-2"><i class="bi bi-calendar3 me-1 inline"></i>Monthly Views</h6>
        <h3 class="font-bold text-green-600 mb-0 text-xl">{{ monthly_views }}</h3>
      </div>
    </div>
  </div>

  <!-- Grafik Views per Course -->
  <div class="bg-white shadow-lg border-0 rounded-xl mb-5">
    <div class="p-4">
      <h3 class="text-center text-gray-500 mb-3 text-lg">Views per Course</h3>
      <div class="relative rounded bg-gray-50 p-3 h-[250px] sm:h-[300px] lg:h-[350px] hover:-translate-y-0.5 transition-all duration-300 hover:shadow-lg">
        <canvas id="viewChart"></canvas>
      </div>
    </div>
  </div>

  <!-- Grafik Comments per Course -->
  <div class="bg-white shadow-lg border-0 rounded-xl">
    <div class="p-4">
      <h3 class="text-center text-gray-500 mb-3 text-lg">Comments per Course</h3>
      <div class="relative rounded bg-gray-50 p-3 h-[250px] sm:h-[300px] lg:h-[350px] hover:-translate-y-0.5 transition-all duration-300 hover:shadow-lg">
        <canvas id="commentChart"></canvas>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap Icons (Tetap gunakan jika diperlukan, atau ganti ke Heroicons) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

<!-- Script lokal Chart.js -->
<script src="{% static 'js/chart.umd.min.js' %}"></script>

<script>
  const viewChart = document.getElementById('viewChart');
  new Chart(viewChart, {
    type: 'bar',
    data: {
      labels: {{ view_by_course|pluck:"course__course_name"|safe }},
      datasets: [{
        label: 'Total Views',
        data: {{ view_by_course|pluck:"total"|safe }},
        backgroundColor: 'rgba(96, 165, 250, 0.8)',
        borderColor: '#1d4ed8',
        borderWidth: 1,
        hoverBackgroundColor: '#1d4ed8',
        hoverBorderColor: '#1e3a8a'
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      animation: {
        duration: 1000,
        easing: 'easeInOutQuad'
      },
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(17, 24, 39, 0.9)',
          titleFont: { size: 14, weight: 'bold' },
          bodyFont: { size: 12 },
          padding: 12,
          cornerRadius: 6,
          callbacks: {
            title: d => d[0].label,
            label: d => `Views: ${d.raw}`
          }
        }
      },
      scales: {
        x: {
          title: {
            display: true,
            text: 'Course',
            font: { size: 14, weight: 'bold' },
            color: '#1e40af',
            padding: 10
          },
          grid: { display: false },
          ticks: { color: '#4b5563', font: { size: 12 } }
        },
        y: {
          title: {
            display: true,
            text: 'Number of Views',
            font: { size: 14, weight: 'bold' },
            color: '#1e40af',
            padding: 10
          },
          beginAtZero: true,
          grid: { color: 'rgba(0, 0, 0, 0.1)' },
          ticks: { color: '#4b5563', font: { size: 12 } }
        }
      }
    }
  });

  const commentChart = document.getElementById('commentChart');
  new Chart(commentChart, {
    type: 'bar',
    data: {
      labels: {{ comment_by_course|pluck:"course__course_name"|safe }},
      datasets: [{
        label: 'Total Comments',
        data: {{ comment_by_course|pluck:"total"|safe }},
        backgroundColor: 'rgba(52, 211, 153, 0.8)',
        borderColor: '#059669',
        borderWidth: 1,
        hoverBackgroundColor: '#059669',
        hoverBorderColor: '#047857'
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      animation: {
        duration: 1000,
        easing: 'easeInOutQuad'
      },
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(17, 24, 39, 0.9)',
          titleFont: { size: 14, weight: 'bold' },
          bodyFont: { size: 12 },
          padding: 12,
          cornerRadius: 6,
          callbacks: {
            title: d => d[0].label,
            label: d => `Comments: ${d.raw}`
          }
        }
      },
      scales: {
        x: {
          title: {
            display: true,
            text: 'Course',
            font: { size: 14, weight: 'bold' },
            color: '#1e40af',
            padding: 10
          },
          grid: { display: false },
          ticks: { color: '#4b5563', font: { size: 12 } }
        },
        y: {
          title: {
            display: true,
            text: 'Number of Comments',
            font: { size: 14, weight: 'bold' },
            color: '#1e40af',
            padding: 10
          },
          beginAtZero: true,
          grid: { color: 'rgba(0, 0, 0, 0.1)' },
          ticks: { color: '#4b5563', font: { size: 12 } }
        }
      }
    }
  });
</script>

{% endblock %}

