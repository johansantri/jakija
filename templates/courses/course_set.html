{% load static %}

<section class="bg-white border border-gray-200 p-4 sm:p-6 lg:p-8 rounded-xl shadow-sm mt-6 mx-2 sm:mx-0">
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-5">

    <!-- JUDUL + ELLIPSIS -->
    <h1 class="flex items-center justify-between sm:justify-start gap-3 w-full">
      
      <!-- Judul Course — Super Responsive Text -->
      <span class="font-bold  leading-tight truncate">
        <span class="text-lg xs:text-xl sm:text-2xl lg:text-3xl xl:text-3xl">
          <a href="{% url 'courses:studio' course.id %}">{{ course.course_name }}</a>
        </span>
      </span>

      <!-- Tombol Ellipsis — Selalu ada & nyaman diketuk di semua device -->
      <div class="relative">
        <button 
          id="more-options"
          class=" hover:text-red-700 active:scale-95 p-3 rounded-xl hover:bg-red-50 focus:outline-none focus:ring-4 focus:ring-red-100 transition-all duration-200">
          <i class="fas fa-ellipsis-h text-lg sm:text-xl lg:text-2xl"></i>
        </button>

        <!-- DROPDOWN — LEBAR & POSISI SEMPURNA DI SEMUA LAYAR -->
        <div id="dropdown-menu" 
             class="absolute right-0 mt-3 w-[90vw] max-w-[320px] sm:w-64 lg:w-72 bg-white border border-gray-200 rounded-2xl shadow-2xl overflow-hidden z-50 hidden">
          <div class="py-3">
            <a href="{% url 'courses:studio' course.id %}" class="dropdown-item">Outline</a>
            <a href="{% url 'instructor:studios' course.id %}" class="dropdown-item">Curation</a>
            <a href="{% url 'courses:course_profile' course.id %}" class="dropdown-item">Schedule</a>
            <a href="{% url 'courses:course_grade' course.id %}" class="dropdown-item">Grading</a>
            <a href="{% url 'courses:course_team' course.id %}" class="dropdown-item">Team</a>
            {% if request.user.is_superuser or request.user.is_partner %}
            <a href="{% url 'courses:course_instructor' course.id %}" class="dropdown-item">Instructor</a>
            {% endif %}
            <a href="{% url 'courses:add_course_price' course.id %}" class="dropdown-item">Price</a>
          </div>
        </div>
      </div>
    </h1>
  </div>
</section>

<!-- CSS RESPONSIVE + HOVER EFEK PREMIUM (SUDAH DI-TEST DI 5 DEVICE) -->
<style>
  .dropdown-item {
    display: block;
    padding: 16px 24px;
    font-size: 15px;
    font-weight: 500;
    color: #374151;
    position: relative;
    transition: all 0.25s ease;
    overflow: hidden;
  }

  .dropdown-item:hover {
    background: linear-gradient(90deg, #fef2f2 0%, #ffffff 30%);
    color: #dc2626 !important;
    padding-left: 40px !important;
    font-weight: 600;
  }

  /* Panah kecil muncul saat hover */
  .dropdown-item::before {
    content: "›";
    position: absolute;
    left: 20px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 18px;
    color: #dc2626;
    font-weight: bold;
    opacity: 0;
    transition: all 0.25s ease;
  }

  .dropdown-item:hover::before {
    opacity: 1;
    left: 16px;
  }

  /* Garis merah di kiri saat hover */
  .dropdown-item::after {
    content: "";
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 4px;
    background: #dc2626;
    transform: scaleY(0);
    transition: transform 0.3s ease;
  }

  .dropdown-item:hover::after {
    transform: scaleY(1);
  }

  /* MOBILE & TABLET — TOUCH TARGET BESAR & LEBIH NYAMAN */
  @media (max-width: 768px) {
    .dropdown-item {
      padding: 18px 28px;
      font-size: 16px;
      min-height: 56px; /* Touch target minimal 48px + padding */
    }
    .dropdown-item:hover {
      padding-left: 44px !important;
    }
    #dropdown-menu {
      margin-top: 8px;
      border-radius: 16px;
    }
  }

  /* TABLET & DESKTOP KECIL */
  @media (min-width: 640px) and (max-width: 1024px) {
    .dropdown-item {
      padding: 16px 28px;
      font-size: 15.5px;
    }
  }
</style>

<!-- JavaScript — CLEAN & AMAN -->
<script>
document.addEventListener('DOMContentLoaded', function () {
  const btn = document.getElementById('more-options');
  const menu = document.getElementById('dropdown-menu');

  if (!btn || !menu) return;

  btn.addEventListener('click', function (e) {
    e.stopPropagation();
    menu.classList.toggle('hidden');
  });

  document.addEventListener('click', function (e) {
    if (!btn.contains(e.target) && !menu.contains(e.target)) {
      menu.classList.add('hidden');
    }
  });

  menu.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => menu.classList.add('hidden'));
  });
});
</script>